<!-- Header -->
<header class="admin-header">
  <div class="header-container">
    <div class="header-left">
      <div class="logo-section">
        <img src="/SHS-main-logo.png" alt="Sorella Home Solutions Logo" class="admin-logo" />
        <h1>{{ isEdit ? 'Edit Blog Post' : 'Create New Blog Post' }}</h1>
      </div>
    </div>
    <div class="header-right">
      <button (click)="logout()" class="logout-button">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
        Logout
      </button>
    </div>
  </div>
</header>

<!-- Main Content -->
<div class="blog-form-container">
  <!-- Back Button -->
  <div class="back-navigation">
    <a href="/admin/blog" class="back-link">← Back to Blog Management</a>
  </div>

  <div class="form-header">
    <div class="header-top">
      <h2>{{ isEdit ? 'Edit Post' : 'Create New Post' }}</h2>
      <div class="header-actions">
        <button type="button" (click)="togglePreview()" class="btn-preview">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
          Preview
        </button>
      </div>
    </div>
    <div class="header-stats">
      <span class="stat-item">
        <strong>{{ totalWordCount }}</strong> words
      </span>
      <span class="stat-item">
        <strong>{{ getReadingTime() }}</strong> min read
      </span>
      <span class="stat-item" *ngIf="autoSaving">
        <span class="auto-saving-dot"></span>
        Auto-saving...
      </span>
      <span class="stat-item" *ngIf="lastAutoSaveTime && !autoSaving" title="Last auto-saved at {{ lastAutoSaveTime }}">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 14px; height: 14px;">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        Auto-saved
      </span>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner">
      <span class="spinner"></span>
    </div>
    <p>Loading blog post...</p>
  </div>

  <div *ngIf="!loading" class="form-wrapper">
    <!-- Success Message -->
    <div *ngIf="success" class="alert alert-success">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
      <span>{{ success }}</span>
    </div>

    <!-- Error Message -->
    <div *ngIf="error" class="alert alert-error">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      <span>{{ error }}</span>
    </div>

    <!-- Preview Modal -->
    <div *ngIf="showPreview" class="preview-modal-overlay" (click)="closePreview()">
      <div class="preview-modal" (click)="$event.stopPropagation()">
        <div class="preview-header">
          <h3>Post Preview</h3>
          <button type="button" (click)="closePreview()" class="btn-close">×</button>
        </div>
        <div class="preview-content">
          <article class="preview-article">
            <h1 class="preview-title">{{ form.get('title')?.value || 'Untitled' }}</h1>
            <p class="preview-subtitle">{{ form.get('subtitle')?.value || 'Subtitle' }}</p>
            
            <div class="preview-meta">
              <span>By {{ form.get('author')?.value || 'Author' }}</span>
              <span>•</span>
              <span>{{ getReadingTime() }} min read</span>
              <span>•</span>
              <span class="category-badge">{{ form.get('category')?.value }}</span>
            </div>

            <div *ngIf="imagePreview" class="preview-featured-image">
              <img [src]="imagePreview" [alt]="form.get('title')?.value" />
            </div>

            <div class="preview-intro">
              {{ form.get('introText')?.value || 'Introduction text...' }}
            </div>

            <div class="preview-content-sections">
              <div *ngFor="let section of contentSections; let i = index" class="preview-section">
                <h2 class="preview-section-heading">{{ section.heading || `Section ${i + 1}` }}</h2>
                <p class="preview-section-content">{{ section.content || 'Content...' }}</p>
              </div>
            </div>

            <div *ngIf="tags.length > 0" class="preview-tags">
              <span *ngFor="let tag of tags" class="preview-tag">{{ tag }}</span>
            </div>
          </article>
        </div>
      </div>
    </div>

    <form [formGroup]="form">
      <!-- Basic Information Section -->
      <div class="form-section">
        <h3>Basic Information</h3>

        <div class="form-row">
          <div class="form-group">
            <label for="title">Title *</label>
            <input
              type="text"
              id="title"
              formControlName="title"
              placeholder="Enter blog post title"
              [class.is-invalid]="submitted && f['title'].errors"
            />
            <div *ngIf="submitted && f['title'].errors" class="error-message">
              <span *ngIf="f['title'].errors['required']">Title is required</span>
              <span *ngIf="f['title'].errors['minlength']">Minimum 5 characters</span>
              <span *ngIf="f['title'].errors['maxlength']">Maximum 200 characters</span>
            </div>
          </div>

          <div class="form-group">
            <label for="author">Author *</label>
            <input
              type="text"
              id="author"
              formControlName="author"
              placeholder="Author name"
              [class.is-invalid]="submitted && f['author'].errors"
            />
            <div *ngIf="submitted && f['author'].errors" class="error-message">
              <span *ngIf="f['author'].errors['required']">Author is required</span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="subtitle">Subtitle *</label>
          <input
            type="text"
            id="subtitle"
            formControlName="subtitle"
            placeholder="Enter blog post subtitle"
            [class.is-invalid]="submitted && f['subtitle'].errors"
          />
          <div *ngIf="submitted && f['subtitle'].errors" class="error-message">
            <span *ngIf="f['subtitle'].errors['required']">Subtitle is required</span>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="category">Category *</label>
            <select
              id="category"
              formControlName="category"
              [class.is-invalid]="submitted && f['category'].errors"
            >
              <option value="">Select a category</option>
              <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
            </select>
            <div *ngIf="submitted && f['category'].errors" class="error-message">
              <span *ngIf="f['category'].errors['required']">Category is required</span>
            </div>
          </div>

          <div class="form-group">
            <label for="published">Publication</label>
            <div class="checkbox-group">
              <input
                type="checkbox"
                id="published"
                formControlName="published"
                (change)="scheduleForLater = false"
              />
              <label for="published" class="checkbox-label">Publish immediately</label>
            </div>
          </div>
        </div>

        <!-- Scheduled Publishing Section -->
        <div class="form-row">
          <div class="form-group">
            <div class="checkbox-group">
              <input
                type="checkbox"
                id="scheduleForLater"
                [checked]="scheduleForLater"
                (change)="scheduleForLater = !scheduleForLater; toggleScheduleForLater()"
              />
              <label for="scheduleForLater" class="checkbox-label">Schedule for later</label>
            </div>
          </div>

          <div class="form-group">
            <div class="checkbox-group">
              <input
                type="checkbox"
                id="featured"
                formControlName="featured"
              />
              <label for="featured" class="checkbox-label">Mark as featured</label>
            </div>
          </div>
        </div>

        <div *ngIf="scheduleForLater" class="form-group">
          <label for="publishDate">Publish Date & Time *</label>
          <input
            type="datetime-local"
            id="publishDate"
            formControlName="publishDate"
            class="datetime-input"
            [class.is-invalid]="submitted && !form.get('publishDate')?.value && scheduleForLater"
            (click)="openDatePicker()"
          />
          <small class="form-hint">Your post will be automatically published at this date and time</small>
        </div>
      </div>

      <!-- Featured Image Section -->
      <div class="form-section">
        <h3>Featured Image</h3>

        <div class="image-upload">
          <div class="image-preview" *ngIf="imagePreview">
            <img [src]="imagePreview" alt="Featured image preview" />
            <button type="button" (click)="removeImage()" class="btn-remove-image">
              Remove Image
            </button>
          </div>

          <div *ngIf="!imagePreview" class="image-input-area">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <circle cx="8.5" cy="8.5" r="1.5"></circle>
              <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
            <p>Click to upload or drag and drop</p>
            <p class="file-info">PNG, JPG, GIF up to 5MB</p>
            <input
              type="file"
              accept="image/*"
              (change)="onImageSelected($event)"
              class="file-input"
            />
          </div>

          <div *ngIf="fileUploadError" class="error-message">
            {{ fileUploadError }}
          </div>
        </div>

        <div *ngIf="submitted && f['featuredImage'].errors" class="error-message">
          <span *ngIf="f['featuredImage'].errors['required']">Featured image is required</span>
        </div>
      </div>

      <!-- Intro & Meta Section -->
      <div class="form-section">
        <h3>Intro & Meta</h3>

        <div class="form-group">
          <label for="introText">Intro Text *</label>
          <textarea
            id="introText"
            formControlName="introText"
            placeholder="Enter introduction text (10-1000 characters)"
            rows="3"
            [class.is-invalid]="submitted && f['introText'].errors"
          ></textarea>
          <div class="char-count">
            {{ form.get('introText')?.value?.length || 0 }} / 1000
          </div>
          <div *ngIf="submitted && f['introText'].errors" class="error-message">
            <span *ngIf="f['introText'].errors['required']">Intro text is required</span>
          </div>
        </div>

        <div class="form-group">
          <label for="metaDescription">Meta Description</label>
          <textarea
            id="metaDescription"
            formControlName="metaDescription"
            placeholder="SEO meta description (up to 160 characters) - Auto-populated from intro text"
            rows="2"
            (input)="onMetaDescriptionChange()"
          ></textarea>
          <div class="char-count">
            {{ form.get('metaDescription')?.value?.length || 0 }} / 160
            <span *ngIf="metaDescriptionAutoGenerated" style="color: #0ea5e9; margin-left: 1rem; font-size: 0.85rem;">
              (Auto-generated)
            </span>
          </div>
        </div>
      </div>

      <!-- Tags Section -->
      <div class="form-section">
        <h3>Tags</h3>

        <div class="tags-input-group">
          <div class="tag-input-wrapper">
            <input
              type="text"
              [(ngModel)]="tagInput"
              (keyup.enter)="addTag()"
              placeholder="Add tags (press Enter)"
              [ngModelOptions]="{ standalone: true }"
              class="tag-input"
            />
            <button type="button" (click)="addTag()" class="btn-add-tag">Add</button>
          </div>

          <div class="tags-display" *ngIf="tags.length > 0">
            <span *ngFor="let tag of tags" class="tag-badge">
              {{ tag }}
              <button type="button" (click)="removeTag(tag)" class="tag-remove">×</button>
            </span>
          </div>

          <p *ngIf="tags.length === 0" class="tags-hint">No tags added yet</p>
        </div>
      </div>

      <!-- Content Sections -->
      <div class="form-section">
        <div class="content-header">
          <h3>Content Sections</h3>
        </div>

        <div *ngFor="let section of contentSections; let i = index" class="content-section">
          <div class="section-header">
            <div class="section-number">Section {{ i + 1 }}</div>
            <div class="section-stats">
              <span class="word-count">{{ sectionWordCounts[i] || 0 }} words</span>
            </div>
          </div>

          <div class="form-group">
            <label>Heading</label>
            <input
              type="text"
              [(ngModel)]="section.heading"
              (ngModelChange)="updateContentSection(i, 'heading', $event)"
              [ngModelOptions]="{ standalone: true }"
              placeholder="Section heading"
            />
          </div>

          <div class="form-group">
            <label>Content</label>
            <textarea
              [(ngModel)]="section.content"
              (ngModelChange)="updateContentSection(i, 'content', $event)"
              [ngModelOptions]="{ standalone: true }"
              placeholder="Section content"
              rows="4"
            ></textarea>
          </div>

          <!-- Section Actions -->
          <div class="section-actions">
            <button
              *ngIf="contentSections.length > 1"
              type="button"
              (click)="removeContentSection(i)"
              class="btn-remove-section"
            >
              Remove Section
            </button>
            <button type="button" (click)="addContentSection()" class="btn-add-section">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              Add Section
            </button>
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button type="button" (click)="cancel()" class="btn-cancel">Cancel</button>
        <button type="button" (click)="toggleRevisionHistory()" class="btn-history" *ngIf="isEdit">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10.5 1.5H3.75A2.25 2.25 0 0 0 1.5 3.75v16.5A2.25 2.25 0 0 0 3.75 22.5h16.5a2.25 2.25 0 0 0 2.25-2.25V13.5"></path>
            <path d="M22.5 2.5L12 13"></path>
            <path d="M22.5 2.5h-7v7"></path>
          </svg>
          History
        </button>
        <button type="button" (click)="toggleSEOPreview()" class="btn-seo">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
          SEO Preview
        </button>
        <button type="button" (click)="toggleSocialPreview()" class="btn-social">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="6" cy="6" r="2"></circle>
            <circle cx="18" cy="6" r="2"></circle>
            <circle cx="12" cy="18" r="2"></circle>
            <line x1="7" y1="8" x2="11" y2="16"></line>
            <line x1="17" y1="8" x2="13" y2="16"></line>
          </svg>
          Social Meta
        </button>
        <button type="button" (click)="toggleJSONLDPreview()" class="btn-jsonld">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
            <path d="M21 3v5h-5"></path>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
            <path d="M3 21v-5h5"></path>
          </svg>
          Schema
        </button>
        <button
          type="button"
          (click)="saveBlog()"
          [disabled]="savingBlog"
          class="btn-save"
        >
          <span *ngIf="!savingBlog">
            {{ isEdit ? 'Update Post' : 'Create Post' }}
          </span>
          <span *ngIf="savingBlog" class="loading-spinner-inline">
            <span class="spinner-mini"></span>
            Saving...
          </span>
        </button>
      </div>
    </form>

    <!-- Revision History Sidebar -->
    <div class="revision-history-sidebar" *ngIf="isEdit && showRevisionHistory">
      <div class="revision-header">
        <h3>Revision History</h3>
        <button type="button" (click)="toggleRevisionHistory()" class="btn-close">×</button>
      </div>

      <!-- Loading State -->
      <div *ngIf="revisionsLoading" class="revision-loading">
        <div class="loading-spinner-small"></div>
        <p>Loading revisions...</p>
      </div>

      <!-- Revisions List -->
      <div *ngIf="!revisionsLoading && revisions.length > 0" class="revisions-list">
        <div *ngFor="let revision of revisions; let i = index" 
             class="revision-item" 
             [class.selected]="selectedRevision?._id === revision._id"
             (click)="selectRevision(revision)">
          <div class="revision-info">
            <div class="revision-type">
              <span class="type-badge" [class]="'type-' + revision.revisionType">
                {{ getRevisionTypeLabel(revision.revisionType) }}
              </span>
              <span class="revision-time">{{ revision.createdAt | date:'short' }}</span>
            </div>
            <div class="revision-changes">
              {{ getSummaryOfChanges(revision) }}
            </div>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!revisionsLoading && revisions.length === 0" class="revision-empty">
        <p>No revisions yet</p>
      </div>

      <!-- Selected Revision Details -->
      <div *ngIf="selectedRevision" class="revision-details">
        <div class="details-header">
          <h4>Revision Details</h4>
        </div>
        <div class="details-content">
          <div class="detail-item" *ngFor="let change of selectedRevision.changes">
            <div class="field-name">{{ change.field }}</div>
            <div class="field-change">
              <div class="old-value" *ngIf="change.oldValue">
                <small>Previous:</small>
                <div class="value-text">{{ change.oldValue | json }}</div>
              </div>
              <div class="new-value" *ngIf="change.newValue">
                <small>Current:</small>
                <div class="value-text">{{ change.newValue | json }}</div>
              </div>
            </div>
          </div>
        </div>

        <button 
          type="button" 
          (click)="restoreRevision()" 
          [disabled]="restoring"
          class="btn-restore">
          {{ restoring ? 'Restoring...' : 'Restore this Revision' }}
        </button>
      </div>
    </div>

    <!-- SEO Preview Sidebar -->
    <div class="seo-preview-sidebar" *ngIf="showSEOPreview">
      <div class="seo-header">
        <h3>SEO Preview</h3>
        <button type="button" (click)="toggleSEOPreview()" class="btn-close">×</button>
      </div>

      <div class="seo-content" *ngIf="seoScore">
        <!-- SEO Score -->
        <div class="seo-score-container" [ngClass]="getSEOScoreClass()">
          <div class="score-display">
            <span class="score-icon">{{ getSEOScoreIcon() }}</span>
            <div class="score-text">
              <span class="score-number">{{ seoScore.score }}/100</span>
              <span class="score-level">{{ seoScore.level | uppercase }}</span>
            </div>
          </div>
        </div>

        <!-- Search Result Preview -->
        <div class="search-preview">
          <h4>Search Result Preview</h4>
          <div class="preview-box">
            <div class="preview-title">{{ form.get('title')?.value || 'Your Page Title' }}</div>
            <div class="preview-url">{{ siteUrl }}/blog/{{ previewSlug || 'your-post-url' }}</div>
            <div class="preview-description">
              {{ form.get('metaDescription')?.value || 'Your meta description will appear here...' }}
            </div>
          </div>
        </div>

        <!-- Character Counts -->
        <div class="character-counts">
          <div class="count-item">
            <div class="count-label">Meta Title</div>
            <div class="count-bar">
              <div class="count-fill" [style.width.%]="Math.min(seoScore.titleLength / 60 * 100, 100)" 
                   [ngClass]="seoScore.titleLength > 60 ? 'count-error' : (seoScore.titleLength >= 30 ? 'count-good' : 'count-warning')"></div>
            </div>
            <div class="count-text" [ngClass]="seoScore.titleLength > 60 ? 'text-error' : (seoScore.titleLength >= 30 ? 'text-good' : 'text-warning')">
              {{ seoScore.titleLength }}/60 characters
            </div>
          </div>

          <div class="count-item">
            <div class="count-label">Meta Description</div>
            <div class="count-bar">
              <div class="count-fill" [style.width.%]="Math.min(seoScore.descriptionLength / 160 * 100, 100)"
                   [ngClass]="seoScore.descriptionLength > 160 ? 'count-error' : (seoScore.descriptionLength >= 120 ? 'count-good' : 'count-warning')"></div>
            </div>
            <div class="count-text" [ngClass]="seoScore.descriptionLength > 160 ? 'text-error' : (seoScore.descriptionLength >= 120 ? 'text-good' : 'text-warning')">
              {{ seoScore.descriptionLength }}/160 characters
            </div>
          </div>
        </div>

        <!-- Suggestions -->
        <div class="seo-suggestions">
          <h4>Suggestions</h4>
          <div class="suggestions-list">
            <div *ngFor="let suggestion of seoScore.suggestions" class="suggestion-item" [ngClass]="'suggestion-' + suggestion.type">
              <div class="suggestion-icon">
                <span *ngIf="suggestion.type === 'success'">✓</span>
                <span *ngIf="suggestion.type === 'warning'">!</span>
                <span *ngIf="suggestion.type === 'error'">✕</span>
              </div>
              <div class="suggestion-content">
                <div class="suggestion-message">{{ suggestion.message }}</div>
                <div class="suggestion-detail" *ngIf="suggestion.suggestion">{{ suggestion.suggestion }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="seo-actions">
          <button 
            type="button" 
            (click)="copyToMetaFields()" 
            class="btn-copy-meta">
            Auto-fill from Content
          </button>
        </div>
      </div>
    </div>

    <!-- Social Meta Tags Sidebar -->
    <div class="social-preview-sidebar" *ngIf="showSocialPreview">
      <div class="social-header">
        <h3>Social Meta Tags</h3>
        <button type="button" (click)="toggleSocialPreview()" class="btn-close">×</button>
      </div>

      <div class="social-content" *ngIf="socialMeta">
        <!-- Platform Selector Tabs -->
        <div class="social-platform-tabs">
          <button 
            type="button" 
            class="platform-tab" 
            [class.active]="activeSocialPlatform === 'facebook'"
            (click)="setSocialPlatform('facebook')">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2C6.48 2 2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v7h3v.1h-6v2h8c3.31 0 6-2.69 6-6V8.5c-.4 0-.8-.02-1.2-.07C18.6 7.77 17.81 7 17 7h-1V3.5C17 2.67 16.33 2 15.5 2S14 2.67 14 3.5V6h-1c-1.66 0-3 1.34-3 3v2H8v3h2v7h3v.1"/>
            </svg>
            Facebook
          </button>
          <button 
            type="button" 
            class="platform-tab" 
            [class.active]="activeSocialPlatform === 'twitter'"
            (click)="setSocialPlatform('twitter')">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2s9 5 20 5a9.5 9.5 0 00-9-5.5c4.75 2.25 7-7 7-11.16z"/>
            </svg>
            Twitter
          </button>
          <button 
            type="button" 
            class="platform-tab" 
            [class.active]="activeSocialPlatform === 'linkedin'"
            (click)="setSocialPlatform('linkedin')">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6zM2 9h4v12H2z"/>
              <circle cx="4" cy="4" r="2"/>
            </svg>
            LinkedIn
          </button>
        </div>

        <!-- Preview Section -->
        <div class="social-preview-section" *ngIf="getSocialPlatformData(activeSocialPlatform) as platformData">
          <h4>Preview</h4>
          
          <!-- Platform-specific preview -->
          <div [ngSwitch]="activeSocialPlatform" class="platform-preview">
            <!-- Facebook Preview -->
            <div *ngSwitchCase="'facebook'" class="facebook-preview">
              <div class="preview-card">
                <div *ngIf="platformData.image" class="preview-image">
                  <img [src]="platformData.image" alt="Preview" />
                </div>
                <div class="preview-content">
                  <div class="preview-domain">sorella-home-solutions.com</div>
                  <div class="preview-title">{{ platformData.title || 'Post title' }}</div>
                  <div class="preview-description">{{ platformData.description || 'Post description will appear here' }}</div>
                </div>
              </div>
            </div>

            <!-- Twitter Preview -->
            <div *ngSwitchCase="'twitter'" class="twitter-preview">
              <div class="preview-card twitter-card">
                <div class="preview-content-twitter">
                  <div class="preview-title">{{ platformData.title || 'Post title' }}</div>
                  <div class="preview-description">{{ platformData.description || 'Post description will appear here' }}</div>
                  <div *ngIf="platformData.image" class="preview-image-twitter">
                    <img [src]="platformData.image" alt="Preview" />
                  </div>
                  <div class="preview-domain-twitter">sorella-home-solutions.com</div>
                </div>
              </div>
            </div>

            <!-- LinkedIn Preview -->
            <div *ngSwitchCase="'linkedin'" class="linkedin-preview">
              <div class="preview-card linkedin-card">
                <div *ngIf="platformData.image" class="preview-image-linkedin">
                  <img [src]="platformData.image" alt="Preview" />
                </div>
                <div class="preview-content-linkedin">
                  <div class="preview-title">{{ platformData.title || 'Post title' }}</div>
                  <div class="preview-description">{{ platformData.description || 'Post description will appear here' }}</div>
                  <div class="preview-domain-linkedin">sorella-home-solutions.com</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Edit Fields Section -->
        <div class="social-edit-section">
          <h4>Edit Tags for {{ activeSocialPlatform | titlecase }}</h4>
          
          <!-- Title Field -->
          <div class="form-group-social">
            <label>Title ({{ activeSocialPlatform === 'facebook' ? '60' : activeSocialPlatform === 'twitter' ? '70' : '100' }} chars)</label>
            <input 
              type="text" 
              [value]="getSocialPlatformData(activeSocialPlatform).title"
              (input)="updateSocialField(activeSocialPlatform, 'title', $any($event.target).value)"
              [attr.maxlength]="activeSocialPlatform === 'facebook' ? 60 : activeSocialPlatform === 'twitter' ? 70 : 100"
              placeholder="Enter social media title"
              class="social-input">
            <div class="char-count">
              {{ (getSocialPlatformData(activeSocialPlatform).title || '').length }}/{{ activeSocialPlatform === 'facebook' ? 60 : activeSocialPlatform === 'twitter' ? 70 : 100 }}
            </div>
          </div>

          <!-- Description Field -->
          <div class="form-group-social">
            <label>Description ({{ activeSocialPlatform === 'twitter' ? '200' : '160' }} chars)</label>
            <textarea 
              [value]="getSocialPlatformData(activeSocialPlatform).description"
              (input)="updateSocialField(activeSocialPlatform, 'description', $any($event.target).value)"
              [attr.maxlength]="activeSocialPlatform === 'twitter' ? 200 : 160"
              placeholder="Enter social media description"
              class="social-textarea"
              rows="3"></textarea>
            <div class="char-count">
              {{ (getSocialPlatformData(activeSocialPlatform).description || '').length }}/{{ activeSocialPlatform === 'twitter' ? 200 : 160 }}
            </div>
          </div>
        </div>

        <!-- Image Section -->
        <div class="social-image-section">
          <h4>Image</h4>
          <div *ngIf="socialImagePreview" class="current-image">
            <img [src]="socialImagePreview" alt="Social media image" />
            <div class="image-label">
              {{ useCustomSocialImage ? 'Custom Image' : 'Blog Featured Image' }}
            </div>
          </div>
          
          <div class="image-actions">
            <div class="image-option">
              <label class="checkbox-label">
                <input 
                  type="checkbox" 
                  [(ngModel)]="useCustomSocialImage"
                  (change)="useCustomSocialImage ? '' : resetSocialImageToDefault()">
                Use Custom Image
              </label>
            </div>
            
            <div *ngIf="useCustomSocialImage" class="upload-area">
              <input 
                type="file" 
                #socialImageInput
                (change)="onSocialImageSelected($event)"
                accept="image/*"
                style="display: none">
              <button 
                type="button" 
                (click)="socialImageInput.click()"
                class="btn-upload-image">
                Upload New Image
              </button>
            </div>
            
            <button 
              type="button" 
              (click)="resetSocialImageToDefault()"
              *ngIf="useCustomSocialImage"
              class="btn-reset-image">
              Use Featured Image
            </button>
          </div>
        </div>

        <!-- Actions -->
        <div class="social-actions">
          <button 
            type="button" 
            (click)="autoFillSocialMeta()" 
            class="btn-autofill-social">
            Auto-fill from Content
          </button>
        </div>
      </div>
    </div>

    <!-- JSON-LD Schema Preview Sidebar -->
    <div class="jsonld-preview-sidebar" *ngIf="showJSONLDPreview">
      <div class="jsonld-header">
        <h3>JSON-LD Schema</h3>
        <button type="button" (click)="toggleJSONLDPreview()" class="btn-close">×</button>
      </div>

      <div class="jsonld-content">
        <!-- Schema Info -->
        <div class="schema-info">
          <div class="info-item">
            <span class="label">Type:</span>
            <span class="value">BlogPosting</span>
          </div>
          <div class="info-item">
            <span class="label">Context:</span>
            <span class="value">schema.org</span>
          </div>
        </div>

        <!-- Schema Preview -->
        <div class="schema-preview-container">
          <div class="schema-toolbar">
            <h4>Schema Code</h4>
            <button 
              type="button" 
              (click)="copyJSONLDToClipboard()"
              class="btn-copy-schema">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
              </svg>
              Copy
            </button>
          </div>
          <pre class="schema-code"><code>{{ jsonLdPreviewFormatted }}</code></pre>
        </div>

        <!-- Validation Info -->
        <div class="schema-validation">
          <div class="validation-item">
            <span class="validation-badge validation-success">✓</span>
            <span class="validation-text">All required fields present</span>
          </div>
          <div class="validation-item">
            <span class="validation-badge validation-info">ℹ</span>
            <span class="validation-text">Test with Google Rich Results Test</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>