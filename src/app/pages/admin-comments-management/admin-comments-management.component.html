<div class="admin-comments">
  <!-- Header -->
  <header class="admin-header">
    <div class="header-container">
      <div class="header-left">
        <div class="logo-section">
          <img src="/SHS-main-logo.png" alt="Sorella Home Solutions Logo" class="admin-logo" />
          <h1>Manage Comments</h1>
        </div>
      </div>
      <div class="header-right">
        <button (click)="logout()" class="logout-button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" y1="12" x2="9" y2="12"></line>
          </svg>
          Logout
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="admin-content">
    <div class="content-container">
      <!-- Back Button -->
      <div class="back-navigation">
        <a href="/admin" class="back-link">‚Üê Back to Dashboard</a>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading" class="loading-container">
        <div class="loading-spinner"></div>
        <p>Loading comments...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !loading" class="error-container">
        <p class="error-message">{{ error }}</p>
        <button (click)="loadComments()" class="retry-button">Retry</button>
      </div>

      <!-- Comments Management -->
      <div *ngIf="!loading && !error" class="comments-section">
        <!-- Filters and Search -->
        <div class="filters-bar">
          <div class="search-box">
            <input 
              type="text" 
              placeholder="Search by author, email, or content..."
              [(ngModel)]="searchTerm"
              (ngModelChange)="onSearchChange()"
              class="search-input"
            />
          </div>
          
          <div class="filter-buttons">
            <button 
              *ngFor="let status of ['all', 'approved', 'pending']"
              [class.active]="filterStatus === status"
              (click)="setFilterStatus(status)"
              class="filter-button"
            >
              {{ status | titlecase }}
            </button>
          </div>
        </div>

        <!-- No Comments -->
        <div *ngIf="filteredComments.length === 0" class="no-comments">
          <p>No comments found.</p>
        </div>

        <!-- Comments List -->
        <div *ngIf="filteredComments.length > 0" class="comments-list">
          <div 
            *ngFor="let comment of filteredComments" 
            class="comment-item"
            [class.approved]="comment.approved"
          >
            <div class="comment-header">
              <div class="comment-meta">
                <h4 class="comment-author">{{ comment.author }}</h4>
                <p class="comment-email">{{ comment.email }}</p>
                <p class="comment-date">{{ formatDate(comment.createdAt) }}</p>
              </div>
              <div class="comment-status">
                <span 
                  class="status-badge"
                  [class.approved]="comment.approved"
                  [class.pending]="!comment.approved"
                >
                  {{ comment.approved ? 'Approved' : 'Pending' }}
                </span>
              </div>
            </div>

            <div class="comment-blog-post">
              <p class="blog-label">On Post:</p>
              <a 
                href="javascript:void(0)" 
                (click)="viewBlogPost(comment.blogPostId)"
                class="blog-title"
              >
                {{ comment.blogPostTitle }}
              </a>
            </div>

            <div class="comment-content">
              <p>{{ comment.content }}</p>
            </div>

            <div class="comment-actions">
              <button 
                *ngIf="!comment.approved"
                (click)="approveComment(comment)"
                class="action-button approve"
              >
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                Approve
              </button>
              
              <button 
                *ngIf="comment.approved"
                (click)="rejectComment(comment)"
                class="action-button reject"
              >
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
                Reject
              </button>

              <button 
                (click)="deleteComment(comment)"
                class="action-button delete"
              >
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3 6 5 6 21 6"></polyline>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                  <line x1="10" y1="11" x2="10" y2="17"></line>
                  <line x1="14" y1="11" x2="14" y2="17"></line>
                </svg>
                Delete
              </button>
            </div>
          </div>
        </div>

        <!-- Stats -->
        <div *ngIf="filteredComments.length > 0" class="comments-stats">
          <p>Showing {{ filteredComments.length }} of {{ comments.length }} comments</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Modal Component -->
  <app-modal></app-modal>
</div>